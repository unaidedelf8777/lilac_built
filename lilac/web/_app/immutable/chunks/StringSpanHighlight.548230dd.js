import{S as Q,i as J,s as x,D as R,Z as W,_ as X,m as k,h as _,n as w,$ as de,b as V,a0 as p,K as _e,a1 as M,M as K,Q as le,q as z,r as D,u as F,k as S,y as ne,l as E,z as ie,F as H,A as se,a7 as ae,W as lt,g as C,d as B,B as oe,a as U,c as Y,v as G,f as Z,a3 as We,a4 as we,N as nt,G as re,L as Xe,X as Ke,Y as it,p as O,ah as st,ao as at,a2 as ot,O as me,ai as rt,e as ye,a8 as Se}from"./index.6d58eddb.js";import{ax as Ee,K as ct,h as Ge,L as dt,Z as Ne,W as ft,a7 as Ze,c as ut,b2 as ht,ak as mt,b6 as _t,b7 as gt,au as bt,ah as pt,a1 as Ce,bv as vt,b9 as kt}from"./Commands.f21feee1.js";import{f as Ve,g as wt}from"./notificationsStore.a58b8b24.js";import{c as yt,S as He,a as St,b as Et}from"./spanHighlight.730a83eb.js";import{c as Be,L as Ie,a as Te}from"./colors.f6cbcb11.js";function Le(n){let e,t;return{c(){e=W("title"),t=z(n[1])},l(l){e=X(l,"title",{});var a=k(e);t=D(a,n[1]),a.forEach(_)},m(l,a){V(l,e,a),p(e,t)},p(l,a){a&2&&F(t,l[1])},d(l){l&&_(e)}}}function Nt(n){let e,t,l=n[1]&&Le(n),a=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:n[0]},{height:n[0]},n[2],n[3]],c={};for(let i=0;i<a.length;i+=1)c=R(c,a[i]);return{c(){e=W("svg"),l&&l.c(),t=W("path"),this.h()},l(i){e=X(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,preserveAspectRatio:!0,width:!0,height:!0});var o=k(e);l&&l.l(o),t=X(o,"path",{d:!0}),k(t).forEach(_),o.forEach(_),this.h()},h(){w(t,"d","M2 2H7V16H2zM23 2H9V16.8027l3.0422 4.5635.8453 5.9165A2.0094 2.0094 0 0014.8672 29H15a3.0033 3.0033 0 003-3V20h8a4.0045 4.0045 0 004-4V9A7.0078 7.0078 0 0023 2z"),de(e,c)},m(i,o){V(i,e,o),l&&l.m(e,null),p(e,t)},p(i,[o]){i[1]?l?l.p(i,o):(l=Le(i),l.c(),l.m(e,t)):l&&(l.d(1),l=null),de(e,c=_e(a,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},o&1&&{width:i[0]},o&1&&{height:i[0]},o&4&&i[2],o&8&&i[3]]))},i:M,o:M,d(i){i&&_(e),l&&l.d()}}}function Ct(n,e,t){let l,a;const c=["size","title"];let i=K(e,c),{size:o=16}=e,{title:s=void 0}=e;return n.$$set=r=>{t(5,e=R(R({},e),le(r))),t(3,i=K(e,c)),"size"in r&&t(0,o=r.size),"title"in r&&t(1,s=r.title)},n.$$.update=()=>{t(4,l=e["aria-label"]||e["aria-labelledby"]||s),t(2,a={"aria-hidden":l?void 0:!0,role:l?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=le(e),[o,s,a,i,l]}class Vt extends Q{constructor(e){super(),J(this,e,Ct,Nt,x,{size:0,title:1})}}function Pe(n){let e,t;return{c(){e=W("title"),t=z(n[1])},l(l){e=X(l,"title",{});var a=k(e);t=D(a,n[1]),a.forEach(_)},m(l,a){V(l,e,a),p(e,t)},p(l,a){a&2&&F(t,l[1])},d(l){l&&_(e)}}}function Ht(n){let e,t,l=n[1]&&Pe(n),a=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:n[0]},{height:n[0]},n[2],n[3]],c={};for(let i=0;i<a.length;i+=1)c=R(c,a[i]);return{c(){e=W("svg"),l&&l.c(),t=W("path"),this.h()},l(i){e=X(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,preserveAspectRatio:!0,width:!0,height:!0});var o=k(e);l&&l.l(o),t=X(o,"path",{d:!0}),k(t).forEach(_),o.forEach(_),this.h()},h(){w(t,"d","M2 16H7V30H2zM23 30H9V15.1973l3.0422-4.5635.8453-5.9165A2.0094 2.0094 0 0114.8672 3H15a3.0033 3.0033 0 013 3v6h8a4.0045 4.0045 0 014 4v7A7.0078 7.0078 0 0123 30z"),de(e,c)},m(i,o){V(i,e,o),l&&l.m(e,null),p(e,t)},p(i,[o]){i[1]?l?l.p(i,o):(l=Pe(i),l.c(),l.m(e,t)):l&&(l.d(1),l=null),de(e,c=_e(a,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},o&1&&{width:i[0]},o&1&&{height:i[0]},o&4&&i[2],o&8&&i[3]]))},i:M,o:M,d(i){i&&_(e),l&&l.d()}}}function Bt(n,e,t){let l,a;const c=["size","title"];let i=K(e,c),{size:o=16}=e,{title:s=void 0}=e;return n.$$set=r=>{t(5,e=R(R({},e),le(r))),t(3,i=K(e,c)),"size"in r&&t(0,o=r.size),"title"in r&&t(1,s=r.title)},n.$$.update=()=>{t(4,l=e["aria-label"]||e["aria-labelledby"]||s),t(2,a={"aria-hidden":l?void 0:!0,role:l?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=le(e),[o,s,a,i,l]}class It extends Q{constructor(e){super(),J(this,e,Bt,Ht,x,{size:0,title:1})}}function Tt(n){let e=(n[1]?"":n[0])+"",t;return{c(){t=z(e)},l(l){t=D(l,e)},m(l,a){V(l,t,a)},p(l,a){a&3&&e!==(e=(l[1]?"":l[0])+"")&&F(t,e)},d(l){l&&_(t)}}}function Lt(n){let e,t,l,a,c;const i=[n[2],{type:"purple"},{icon:Ee}];let o={$$slots:{default:[Tt]},$$scope:{ctx:n}};for(let s=0;s<i.length;s+=1)o=R(o,i[s]);return t=new ct({props:o}),{c(){e=S("div"),ne(t.$$.fragment),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=k(e);ie(t.$$.fragment,r),r.forEach(_),this.h()},h(){w(e,"class","embedding-badge truncate"),H(e,"embedding-badge-nolabel",n[1])},m(s,r){V(s,e,r),se(t,e,null),l=!0,a||(c=ae(Ge.call(null,e,{text:"Embedding index"})),a=!0)},p(s,[r]){const d=r&4?_e(i,[r&4&&lt(s[2]),i[1],r&0&&{icon:Ee}]):{};r&11&&(d.$$scope={dirty:r,ctx:s}),t.$set(d),(!l||r&2)&&H(e,"embedding-badge-nolabel",s[1])},i(s){l||(C(t.$$.fragment,s),l=!0)},o(s){B(t.$$.fragment,s),l=!1},d(s){s&&_(e),oe(t),a=!1,c()}}}function Pt(n,e,t){const l=["embedding","hideEmbeddingName"];let a=K(e,l),{embedding:c}=e,{hideEmbeddingName:i=!1}=e;return n.$$set=o=>{e=R(R({},e),le(o)),t(2,a=K(e,l)),"embedding"in o&&t(0,c=o.embedding),"hideEmbeddingName"in o&&t(1,i=o.hideEmbeddingName)},[c,i,a]}class Mt extends Q{constructor(e){super(),J(this,e,Pt,Lt,x,{embedding:0,hideEmbeddingName:1})}}function Me(n,e,t){const l=n.slice();return l[12]=e[t],l}function ze(n){let e,t,l=n[0].conceptNamespace+"",a,c,i=n[0].conceptName+"",o,s,r,d,u,h,m,v,g,b,L;return u=new It({}),v=new Vt({}),{c(){e=S("div"),t=S("div"),a=z(l),c=z(" / "),o=z(i),s=U(),r=S("div"),d=S("button"),ne(u.$$.fragment),h=U(),m=S("button"),ne(v.$$.fragment),this.h()},l(N){e=E(N,"DIV",{class:!0});var T=k(e);t=E(T,"DIV",{class:!0});var P=k(t);a=D(P,l),c=D(P," / "),o=D(P,i),P.forEach(_),s=Y(T),r=E(T,"DIV",{class:!0});var I=k(r);d=E(I,"BUTTON",{class:!0});var A=k(d);ie(u.$$.fragment,A),A.forEach(_),h=Y(I),m=E(I,"BUTTON",{class:!0});var $=k(m);ie(v.$$.fragment,$),$.forEach(_),I.forEach(_),T.forEach(_),this.h()},h(){w(t,"class","flex-grow"),w(d,"class","p-1"),w(m,"class","p-1"),w(r,"class","shrink-0"),w(e,"class","flex flex-row items-center justify-between gap-x-4 p-2")},m(N,T){V(N,e,T),p(e,t),p(t,a),p(t,c),p(t,o),p(e,s),p(e,r),p(r,d),se(u,d,null),p(r,h),p(r,m),se(v,m,null),g=!0,b||(L=[re(d,"click",n[8]),re(m,"click",n[9])],b=!0)},p(N,T){(!g||T&1)&&l!==(l=N[0].conceptNamespace+"")&&F(a,l),(!g||T&1)&&i!==(i=N[0].conceptName+"")&&F(o,i)},i(N){g||(C(u.$$.fragment,N),C(v.$$.fragment,N),g=!0)},o(N){B(u.$$.fragment,N),B(v.$$.fragment,N),g=!1},d(N){N&&_(e),oe(u),oe(v),b=!1,Xe(L)}}}function De(n){let e,t=[],l=new Map,a,c=n[2];const i=o=>o[12];for(let o=0;o<c.length;o+=1){let s=Me(n,c,o),r=i(s);l.set(r,t[o]=Ae(r,s))}return{c(){e=S("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=E(o,"DIV",{class:!0});var s=k(e);for(let r=0;r<t.length;r+=1)t[r].l(s);s.forEach(_),this.h()},h(){w(e,"class","more-button flex flex-col")},m(o,s){V(o,e,s);for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(e,null);a=!0},p(o,s){s&29&&(c=o[2],G(),t=Ke(t,s,i,1,o,c,l,e,it,Ae,null,Me),Z())},i(o){if(!a){for(let s=0;s<c.length;s+=1)C(t[s]);a=!0}},o(o){for(let s=0;s<t.length;s+=1)B(t[s]);a=!1},d(o){o&&_(e);for(let s=0;s<t.length;s+=1)t[s].d()}}}function Ae(n,e){let t,l,a,c,i,o,s,r,d;i=new Mt({props:{class:"hover:cursor-pointer",embedding:e[12]}});function u(){return e[10](e[12])}return{key:n,first:null,c(){t=S("button"),l=S("div"),a=z("Find similar"),c=U(),ne(i.$$.fragment),o=U(),this.h()},l(h){t=E(h,"BUTTON",{class:!0});var m=k(t);l=E(m,"DIV",{});var v=k(l);a=D(v,"Find similar"),v.forEach(_),c=Y(m),ie(i.$$.fragment,m),o=Y(m),m.forEach(_),this.h()},h(){w(t,"class","flex w-full items-center justify-between"),this.first=t},m(h,m){V(h,t,m),p(t,l),p(l,a),p(t,c),se(i,t,null),p(t,o),s=!0,r||(d=re(t,"click",u),r=!0)},p(h,m){e=h;const v={};m&4&&(v.embedding=e[12]),i.$set(v)},i(h){s||(C(i.$$.fragment,h),s=!0)},o(h){B(i.$$.fragment,h),s=!1},d(h){h&&_(t),oe(i),r=!1,d()}}}function zt(n){let e,t,l,a,c,i,o,s=n[0].conceptName!=null&&n[0].conceptNamespace!=null&&ze(n),r=n[3]!=null&&De(n);return{c(){e=S("div"),s&&s.c(),t=U(),r&&r.c(),this.h()},l(d){e=E(d,"DIV",{style:!0,class:!0});var u=k(e);s&&s.l(u),t=Y(u),r&&r.l(u),u.forEach(_),this.h()},h(){w(e,"style",l=n[1]!=null?`left: ${n[1].x}px; top: ${n[1].y}px`:""),w(e,"class","absolute z-10 inline-flex -translate-x-1/2 translate-y-6 flex-col divide-y divide-gray-200 rounded border border-gray-200 bg-white shadow")},m(d,u){V(d,e,u),s&&s.m(e,null),p(e,t),r&&r.m(e,null),c=!0,i||(o=ae(yt.call(null,e,n[11])),i=!0)},p(d,[u]){d[0].conceptName!=null&&d[0].conceptNamespace!=null?s?(s.p(d,u),u&1&&C(s,1)):(s=ze(d),s.c(),C(s,1),s.m(e,t)):s&&(G(),B(s,1,1,()=>{s=null}),Z()),d[3]!=null?r?(r.p(d,u),u&8&&C(r,1)):(r=De(d),r.c(),C(r,1),r.m(e,null)):r&&(G(),B(r,1,1,()=>{r=null}),Z()),(!c||u&2&&l!==(l=d[1]!=null?`left: ${d[1].x}px; top: ${d[1].y}px`:""))&&w(e,"style",l)},i(d){c||(C(s),C(r),We(()=>{c&&(a||(a=we(e,Ve,{duration:60},!0)),a.run(1))}),c=!0)},o(d){B(s),B(r),a||(a=we(e,Ve,{duration:60},!1)),a.run(0),c=!1},d(d){d&&_(e),s&&s.d(),r&&r.d(),d&&a&&a.end(),i=!1,o()}}}function Dt(n,e,t){let{details:l}=e,{clickPosition:a}=e,{embeddings:c}=e,{addConceptLabel:i}=e,{findSimilar:o}=e,{addNotification:s}=e;const r=nt();function d(g){if(!l.conceptName||!l.conceptNamespace)throw Error("Label could not be added, no active concept.");i(l.conceptNamespace,l.conceptName,l.text,g),s({kind:"success",title:`[${g===!0?"Positive":"Negative"}] Concept label added`,subtitle:dt(l.conceptNamespace,l.conceptName),message:l.text}),r("click")}const u=()=>d(!0),h=()=>d(!1),m=g=>{o&&o(g,l.text),r("click")},v=()=>r("close");return n.$$set=g=>{"details"in g&&t(0,l=g.details),"clickPosition"in g&&t(1,a=g.clickPosition),"embeddings"in g&&t(2,c=g.embeddings),"addConceptLabel"in g&&t(6,i=g.addConceptLabel),"findSimilar"in g&&t(3,o=g.findSimilar),"addNotification"in g&&t(7,s=g.addNotification)},[l,a,c,o,r,d,i,s,u,h,m,v]}class At extends Q{constructor(e){super(),J(this,e,Dt,zt,x,{details:0,clickPosition:1,embeddings:2,addConceptLabel:6,findSimilar:3,addNotification:7})}}function Ot(n,e){let t,l=e;n.addEventListener("click",i=>a(i));function a(i){l.disabled||(t=new At({props:{details:l.details(),clickPosition:{x:i.clientX,y:i.clientY},embeddings:l.embeddings,addConceptLabel:l.addConceptLabel,addNotification:l.addNotification,findSimilar:l.findSimilar},target:document.body}),t.$on("close",c),t.$on("click",c))}function c(){t==null||t.$destroy(),t=void 0}return{update(i){l=i,t==null||t.$set({details:l.details()})},destroy(){c()}}}function Oe(n,e,t){const l=n.slice();return l[7]=e[t],l}function Re(n,e){let t,l,a=e[7].info.name+"",c,i,o,s,r=Fe(e[7])+"",d,u;return{key:n,first:null,c(){t=S("div"),l=S("div"),c=z(a),i=U(),o=S("div"),s=S("span"),d=z(r),u=U(),this.h()},l(h){t=E(h,"DIV",{class:!0});var m=k(t);l=E(m,"DIV",{class:!0});var v=k(l);c=D(v,a),v.forEach(_),i=Y(m),o=E(m,"DIV",{class:!0});var g=k(o);s=E(g,"SPAN",{class:!0});var b=k(s);d=D(b,r),b.forEach(_),g.forEach(_),u=Y(m),m.forEach(_),this.h()},h(){w(l,"class","named-value-name table-cell max-w-xs truncate pr-2 svelte-1689hje"),w(s,"class","px-1"),H(s,"font-bold",e[7].info.type==="keyword"||e[7].info.type==="metadata"&&!Ne(e[7].info.dtype)),O(s,"background-color",(e[7].info.type==="concept_score"||e[7].info.type==="semantic_similarity")&&typeof e[7].value=="number"?Be(e[7].value):""),w(o,"class","table-cell rounded text-right"),w(t,"class","table-row"),this.first=t},m(h,m){V(h,t,m),p(t,l),p(l,c),p(t,i),p(t,o),p(o,s),p(s,d),p(t,u)},p(h,m){e=h,m&1&&a!==(a=e[7].info.name+"")&&F(c,a),m&1&&r!==(r=Fe(e[7])+"")&&F(d,r),m&1&&H(s,"font-bold",e[7].info.type==="keyword"||e[7].info.type==="metadata"&&!Ne(e[7].info.dtype)),m&1&&O(s,"background-color",(e[7].info.type==="concept_score"||e[7].info.type==="semantic_similarity")&&typeof e[7].value=="number"?Be(e[7].value):"")},d(h){h&&_(t)}}}function Rt(n){let e,t,l=[],a=new Map,c,i=`${n[4]}px`,o=`${Math.min(n[1],n[3]-n[2]-20)}px`,s=n[0];const r=d=>d[7];for(let d=0;d<s.length;d+=1){let u=Oe(n,s,d),h=r(u);a.set(h,l[d]=Re(h,u))}return{c(){e=S("div"),t=S("div");for(let d=0;d<l.length;d+=1)l[d].c();this.h()},l(d){e=E(d,"DIV",{role:!0,class:!0});var u=k(e);t=E(u,"DIV",{class:!0});var h=k(t);for(let m=0;m<l.length;m+=1)l[m].l(h);h.forEach(_),u.forEach(_),this.h()},h(){w(t,"class","table border-spacing-y-2"),w(e,"role","tooltip"),w(e,"class","absolute max-w-fit -translate-y-full break-words border border-gray-300 bg-white px-2 shadow-md"),We(()=>n[6].call(e)),H(e,"hidden",n[0].length===0),O(e,"top",i),O(e,"left",o)},m(d,u){V(d,e,u),p(e,t);for(let h=0;h<l.length;h+=1)l[h]&&l[h].m(t,null);c=st(e,n[6].bind(e))},p(d,[u]){u&1&&(s=d[0],l=Ke(l,u,r,1,d,s,a,t,at,Re,null,Oe)),u&1&&H(e,"hidden",d[0].length===0),u&6&&o!==(o=`${Math.min(d[1],d[3]-d[2]-20)}px`)&&O(e,"left",o)},i:M,o:M,d(d){d&&_(e);for(let u=0;u<l.length;u+=1)l[u].d();c()}}}function Fe(n){return typeof n.value=="number"?n.value.toFixed(3):n.info.dtype.type==="string_span"?"true":n.value}function Ft(n,e,t){let{namedValues:l}=e,{x:a}=e,{y:c}=e;const i=window.innerWidth;let o=0;const s=c-1;function r(){o=this.clientWidth,t(2,o)}return n.$$set=d=>{"namedValues"in d&&t(0,l=d.namedValues),"x"in d&&t(1,a=d.x),"y"in d&&t(5,c=d.y)},[l,a,o,i,s,c,r]}class Ut extends Q{constructor(e){super(),J(this,e,Ft,Rt,x,{namedValues:0,x:1,y:5})}}function Yt(n,e){let t,l=e;const a=()=>i();l.isHovered&&c();function c(){const o=l.namedValues.filter(h=>Array.from(l.spansHovered).some(m=>{const v=ft(m);return Ze(h.specificPath.slice(0,v.length),v)}));l.itemScrollContainer!=null&&l.itemScrollContainer.addEventListener("scroll",a);const s=n.getBoundingClientRect(),r=window.getComputedStyle(n),d=parseInt(r.getPropertyValue("line-height")),u=s.height>d?s.x+n.offsetLeft||n.clientLeft:s.x;t=new Ut({props:{namedValues:o,x:u,y:s.top},target:document.body})}function i(){var o;t==null||t.$destroy(),(o=l.itemScrollContainer)==null||o.removeEventListener("scroll",a)}return{update(o){i(),l=o,l.isHovered&&c()},destroy(){i()}}}function Ue(n,e,t){const l=n.slice();return l[34]=e[t],l}function jt(n){const e=n.slice(),t=e[34].renderSpan;return e[37]=t,e}function qt(n){let e,t,l,a;return{c(){e=S("span"),t=z(`...
      `),this.h()},l(c){e=E(c,"SPAN",{class:!0});var i=k(e);t=D(i,`...
      `),i.forEach(_),this.h()},h(){w(e,"class","highlight-span text-sm leading-5 svelte-1e6kot5")},m(c,i){V(c,e,i),p(e,t),l||(a=ae(Ge.call(null,e,{text:`Some text was hidden to improve readability. 
Click "Show all" to show the entire document.`})),l=!0)},p:M,i:M,o:M,d(c){c&&_(e),l=!1,a()}}}function Wt(n){let e,t,l,a,c,i,o,s;const r=[Kt,Xt],d=[];function u(g,b){return g[2]?0:1}t=u(n),l=d[t]=r[t](n);function h(){return n[30](n[37])}function m(){return n[31](n[37])}function v(){return n[32](n[37])}return{c(){e=S("span"),l.c(),this.h()},l(g){e=E(g,"SPAN",{class:!0});var b=k(e);l.l(b),b.forEach(_),this.h()},h(){w(e,"class","hover:cursor-poiner highlight-span break-words text-sm leading-5 svelte-1e6kot5"),H(e,"highlighted",n[37].isHighlighted),H(e,"hover:cursor-pointer",n[1].length>0),H(e,"font-bold",n[37].isBlackBolded),H(e,"font-medium",n[37].isHighlightBolded&&!n[37].isBlackBolded),O(e,"color",n[37].isHighlightBolded&&!n[37].isBlackBolded?Ie:""),O(e,"background-color",n[37].isHovered?Te(je):n[37].backgroundColor)},m(g,b){V(g,e,b),d[t].m(e,null),i=!0,o||(s=[ae(a=Yt.call(null,e,{namedValues:n[37].namedValues,isHovered:n[37].isFirstHover,spansHovered:n[5],itemScrollContainer:n[8]})),ae(c=Ot.call(null,e,{details:h,findSimilar:n[9].page==="datasets"?n[17]:null,embeddings:n[3],addConceptLabel:n[15],addNotification:n[18]!=null?n[18].addNotification:qe,disabled:n[37].paths.length===0||n[3].length===0})),re(e,"mouseenter",m),re(e,"mouseleave",v)],o=!0)},p(g,b){n=g;let L=t;t=u(n),t===L?d[t].p(n,b):(G(),B(d[L],1,1,()=>{d[L]=null}),Z(),l=d[t],l?l.p(n,b):(l=d[t]=r[t](n),l.c()),C(l,1),l.m(e,null)),a&&Se(a.update)&&b[0]&352&&a.update.call(null,{namedValues:n[37].namedValues,isHovered:n[37].isFirstHover,spansHovered:n[5],itemScrollContainer:n[8]}),c&&Se(c.update)&&b[0]&584&&c.update.call(null,{details:h,findSimilar:n[9].page==="datasets"?n[17]:null,embeddings:n[3],addConceptLabel:n[15],addNotification:n[18]!=null?n[18].addNotification:qe,disabled:n[37].paths.length===0||n[3].length===0}),(!i||b[0]&64)&&H(e,"highlighted",n[37].isHighlighted),(!i||b[0]&2)&&H(e,"hover:cursor-pointer",n[1].length>0),(!i||b[0]&64)&&H(e,"font-bold",n[37].isBlackBolded),(!i||b[0]&64)&&H(e,"font-medium",n[37].isHighlightBolded&&!n[37].isBlackBolded),b[0]&64&&O(e,"color",n[37].isHighlightBolded&&!n[37].isBlackBolded?Ie:""),b[0]&64&&O(e,"background-color",n[37].isHovered?Te(je):n[37].backgroundColor)},i(g){i||(C(l),i=!0)},o(g){B(l),i=!1},d(g){g&&_(e),d[t].d(),o=!1,Xe(s)}}}function Xt(n){let e=n[34].snippetText+"",t;return{c(){t=z(e)},l(l){t=D(l,e)},m(l,a){V(l,t,a)},p(l,a){a[0]&64&&e!==(e=l[34].snippetText+"")&&F(t,e)},i:M,o:M,d(l){l&&_(t)}}}function Kt(n){let e,t,l,a;return t=new kt({props:{source:n[34].snippetText}}),{c(){e=S("div"),ne(t.$$.fragment),l=U(),this.h()},l(c){e=E(c,"DIV",{class:!0});var i=k(e);ie(t.$$.fragment,i),i.forEach(_),l=Y(c),this.h()},h(){w(e,"class","markdown")},m(c,i){V(c,e,i),se(t,e,null),V(c,l,i),a=!0},p(c,i){const o={};i[0]&64&&(o.source=c[34].snippetText),t.$set(o)},i(c){a||(C(t.$$.fragment,c),a=!0)},o(c){B(t.$$.fragment,c),a=!1},d(c){c&&_(e),oe(t),c&&_(l)}}}function Ye(n){let e,t,l,a;const c=[Wt,qt],i=[];function o(r,d){return r[34].isEllipsis?1:0}function s(r,d){return d===0?jt(r):r}return e=o(n),t=i[e]=c[e](s(n,e)),{c(){t.c(),l=ye()},l(r){t.l(r),l=ye()},m(r,d){i[e].m(r,d),V(r,l,d),a=!0},p(r,d){let u=e;e=o(r),e===u?i[e].p(s(r,e),d):(G(),B(i[u],1,1,()=>{i[u]=null}),Z(),t=i[e],t?t.p(s(r,e),d):(t=i[e]=c[e](s(r,e)),t.c()),C(t,1),t.m(l.parentNode,l))},i(r){a||(C(t),a=!0)},o(r){B(t),a=!1},d(r){i[e].d(r),r&&_(l)}}}function Gt(n){let e,t,l=n[6],a=[];for(let i=0;i<l.length;i+=1)a[i]=Ye(Ue(n,l,i));const c=i=>B(a[i],1,1,()=>{a[i]=null});return{c(){e=S("div");for(let i=0;i<a.length;i+=1)a[i].c();this.h()},l(i){e=E(i,"DIV",{class:!0});var o=k(e);for(let s=0;s<a.length;s+=1)a[s].l(o);o.forEach(_),this.h()},h(){w(e,"class","overflow-x-hidden text-ellipsis whitespace-break-spaces svelte-1e6kot5"),H(e,"text-preview-overlay",n[0]&&n[7]>He&&!n[4])},m(i,o){V(i,e,o);for(let s=0;s<a.length;s+=1)a[s]&&a[s].m(e,null);t=!0},p(i,o){if(o[0]&441198){l=i[6];let s;for(s=0;s<l.length;s+=1){const r=Ue(i,l,s);a[s]?(a[s].p(r,o),C(a[s],1)):(a[s]=Ye(r),a[s].c(),C(a[s],1),a[s].m(e,null))}for(G(),s=l.length;s<a.length;s+=1)c(s);Z()}(!t||o[0]&145)&&H(e,"text-preview-overlay",i[0]&&i[7]>He&&!i[4])},i(i){if(!t){for(let o=0;o<l.length;o+=1)C(a[o]);t=!0}},o(i){a=a.filter(Boolean);for(let o=0;o<a.length;o+=1)B(a[o]);t=!1},d(i){i&&_(e),ot(a,i)}}}const je=.9,qe=()=>null;function Zt(n,e,t){let l,a,c,i,o,{text:s}=e,{row:r}=e,{field:d=void 0}=e,{spanPaths:u}=e,{path:h=void 0}=e,{spanValueInfos:m}=e,{markdown:v=!1}=e,{embeddings:g}=e,{datasetViewStore:b=void 0}=e,{isExpanded:L=!1}=e,{textIsOverBudget:N=!1}=e;const T=ut();me(n,T,f=>t(9,o=f));let P,I={},A=new Set;const $=f=>{f.paths.forEach(y=>A.add(y)),t(5,A)},ge=f=>{f.paths.forEach(y=>A.delete(y)),t(5,A)};let q={};const be=f=>{const j={conceptName:null,conceptNamespace:null,text:a.filter(ee=>ee.paths.some(he=>((f==null?void 0:f.paths)||[]).some(te=>Ze(te,he)))).map(ee=>ee.text).join("")};for(const ee of Object.keys(f.originalSpans)){const he=(I[ee]||[]).filter(te=>te.type==="concept_score");for(const te of he){const ke=te.signal;j.conceptName=ke.concept_name,j.conceptNamespace=ke.namespace;break}}return j},pe=ht();me(n,pe,f=>t(33,c=f));const Qe=(f,y,ue,j)=>{if(!y||!f)throw Error("Label could not be added, no active concept.");c.mutate([f,y,{insert:[{text:ue,label:j}]}])};let ce,ve=rt(mt);me(n,ve,f=>t(8,i=f));const Je=(f,y)=>{b==null||d==null||b.addSearch({path:d.path,type:"semantic",query_type:"document",query:y,embedding:f})},xe=wt();let fe=0;const $e=f=>be(f),et=f=>$(f),tt=f=>ge(f);return n.$$set=f=>{"text"in f&&t(19,s=f.text),"row"in f&&t(20,r=f.row),"field"in f&&t(21,d=f.field),"spanPaths"in f&&t(1,u=f.spanPaths),"path"in f&&t(22,h=f.path),"spanValueInfos"in f&&t(23,m=f.spanValueInfos),"markdown"in f&&t(2,v=f.markdown),"embeddings"in f&&t(3,g=f.embeddings),"datasetViewStore"in f&&t(24,b=f.datasetViewStore),"isExpanded"in f&&t(4,L=f.isExpanded),"textIsOverBudget"in f&&t(0,N=f.textIsOverBudget)},n.$$.update=()=>{if(n.$$.dirty[0]&5242882&&(t(25,P={}),u.forEach(f=>{let y=_t(r,f);gt(f,h)&&(y=y.filter(j=>bt(pt.path(j),h)||h==null)),t(25,P[Ce(f)]=y,P)})),n.$$.dirty[0]&75497472){t(26,I={});for(const f of m){const y=Ce(f.spanPath);I[y]==null&&t(26,I[y]=[],I),I[y].push(f)}}if(n.$$.dirty[0]&34078720&&t(29,l=vt(s,P)),n.$$.dirty[0]&603979808&&t(28,a=St(l,I,A)),n.$$.dirty[0]&671088640){t(27,q={});for(const f of l)for(const y of f.paths)t(27,q[y]=q[y]||[],q),q[y].push(f)}if(n.$$.dirty[0]&268435472&&t(6,{snippetSpans:ce,textIsOverBudget:N}=Et(a,L),ce,(t(0,N),t(28,a),t(4,L),t(29,l),t(26,I),t(5,A),t(19,s),t(25,P),t(23,m),t(1,u),t(20,r),t(22,h))),n.$$.dirty[0]&192){t(7,fe=0);for(const f of ce)f.isEllipsis||t(7,fe+=f.snippetText.length)}},[N,u,v,g,L,A,ce,fe,i,o,T,$,ge,be,pe,Qe,ve,Je,xe,s,r,d,h,m,b,P,I,q,a,l,$e,et,tt]}class tl extends Q{constructor(e){super(),J(this,e,Zt,Gt,x,{text:19,row:20,field:21,spanPaths:1,path:22,spanValueInfos:23,markdown:2,embeddings:3,datasetViewStore:24,isExpanded:4,textIsOverBudget:0},null,[-1,-1])}}export{Mt as E,tl as S,It as T,Vt as a};

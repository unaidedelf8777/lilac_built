import{S as pe,i as ge,s as be,k as N,a as A,l as C,m as R,c as M,h as _,n as q,b as $,a0 as E,g as w,v as G,d as D,f as K,O as x,y as U,z as W,A as z,B as J,q as F,e as ee,r as P,u as X,a1 as Z,ab as Q,w as Ie,U as $e,V as De}from"../chunks/index.6d58eddb.js";import{b as Te,P as Ee}from"../chunks/Page.a0832e69.js";import{g as Ve}from"../chunks/navigation.aea35273.js";import{D as ye,R as Ne}from"../chunks/DatasetSettingsFields.eb88d2cc.js";import{aH as Ce,aV as Re,aS as Fe,q as Pe,ae as qe,a2 as Oe,a5 as Be,a6 as Le,aM as He,a8 as ne,af as Ae,aj as Me,y as Ue,ah as We,ai as ze,B as Je,ab as je,c as Ge}from"../chunks/Commands.f21feee1.js";import{T as he}from"../chunks/ToastNotification.0ea457ce.js";function re(a){let s,t;return s=new he({props:{hideCloseButton:!0,kind:"warning",fullWidth:!0,lowContrast:!0,title:"Unknown task",caption:"This could be from a stale link, or a new server instance."}}),{c(){U(s.$$.fragment)},l(e){W(s.$$.fragment,e)},m(e,i){z(s,e,i),t=!0},i(e){t||(w(s.$$.fragment,e),t=!0)},o(e){D(s.$$.fragment,e),t=!1},d(e){J(s,e)}}}function oe(a){let s,t,e,i,n,l,r,m,o,v,p,k,g,T,S,u=a[3].status==="error"&&fe(a),f=a[3].status!="error"&&ue(a);const c=[Xe,Ke],h=[];function O(d,b){return d[3].status=="completed"?0:d[3].status==="error"?1:-1}return~(k=O(a))&&(g=h[k]=c[k](a)),{c(){s=N("section"),t=N("div"),e=F('Step 1: Load dataset "'),i=F(a[0]),n=F("/"),l=F(a[1]),r=F('"'),m=A(),o=N("div"),u&&u.c(),v=A(),f&&f.c(),p=A(),g&&g.c(),T=ee(),this.h()},l(d){s=C(d,"SECTION",{class:!0});var b=R(s);t=C(b,"DIV",{class:!0});var V=R(t);e=P(V,'Step 1: Load dataset "'),i=P(V,a[0]),n=P(V,"/"),l=P(V,a[1]),r=P(V,'"'),V.forEach(_),m=M(b),o=C(b,"DIV",{class:!0});var j=R(o);u&&u.l(j),j.forEach(_),v=M(b),f&&f.l(b),b.forEach(_),p=M(d),g&&g.l(d),T=ee(),this.h()},h(){q(t,"class","text-2xl text-gray-700"),q(o,"class","text-base"),q(s,"class","flex flex-col gap-y-2")},m(d,b){$(d,s,b),E(s,t),E(t,e),E(t,i),E(t,n),E(t,l),E(t,r),E(s,m),E(s,o),u&&u.m(o,null),E(s,v),f&&f.m(s,null),$(d,p,b),~k&&h[k].m(d,b),$(d,T,b),S=!0},p(d,b){(!S||b&1)&&X(i,d[0]),(!S||b&2)&&X(l,d[1]),d[3].status==="error"?u?u.p(d,b):(u=fe(d),u.c(),u.m(o,null)):u&&(u.d(1),u=null),d[3].status!="error"?f?(f.p(d,b),b&8&&w(f,1)):(f=ue(d),f.c(),w(f,1),f.m(s,null)):f&&(G(),D(f,1,1,()=>{f=null}),K());let V=k;k=O(d),k===V?~k&&h[k].p(d,b):(g&&(G(),D(h[V],1,1,()=>{h[V]=null}),K()),~k?(g=h[k],g?g.p(d,b):(g=h[k]=c[k](d),g.c()),w(g,1),g.m(T.parentNode,T)):g=null)},i(d){S||(w(f),w(g),S=!0)},o(d){D(f),D(g),S=!1},d(d){d&&_(s),u&&u.d(),f&&f.d(),d&&_(p),~k&&h[k].d(d),d&&_(T)}}}function fe(a){let s,t,e,i;return{c(){s=F("Error loading "),t=F(a[0]),e=F("/"),i=F(a[1])},l(n){s=P(n,"Error loading "),t=P(n,a[0]),e=P(n,"/"),i=P(n,a[1])},m(n,l){$(n,s,l),$(n,t,l),$(n,e,l),$(n,i,l)},p(n,l){l&1&&X(t,n[0]),l&2&&X(i,n[1])},d(n){n&&_(s),n&&_(t),n&&_(e),n&&_(i)}}}function ue(a){var r,m;let s,t,e,i,n;t=new Te({props:{labelText:a[3].message||"",helperText:a[3].status!="completed"?a[3].details||void 0:"",value:a[3].status==="completed"?1:a[6],max:1,status:a[17][a[3].status]}});let l=((m=(r=a[5])==null?void 0:r.data)==null?void 0:m.total_num_rows)!=null&&de(a);return{c(){s=N("div"),U(t.$$.fragment),e=A(),i=N("div"),l&&l.c(),this.h()},l(o){s=C(o,"DIV",{class:!0});var v=R(s);W(t.$$.fragment,v),v.forEach(_),e=M(o),i=C(o,"DIV",{class:!0});var p=R(i);l&&l.l(p),p.forEach(_),this.h()},h(){q(s,"class","mt-2"),q(i,"class","text-sm text-gray-700")},m(o,v){$(o,s,v),z(t,s,null),$(o,e,v),$(o,i,v),l&&l.m(i,null),n=!0},p(o,v){var k,g;const p={};v&8&&(p.labelText=o[3].message||""),v&8&&(p.helperText=o[3].status!="completed"?o[3].details||void 0:""),v&72&&(p.value=o[3].status==="completed"?1:o[6]),v&8&&(p.status=o[17][o[3].status]),t.$set(p),((g=(k=o[5])==null?void 0:k.data)==null?void 0:g.total_num_rows)!=null?l?l.p(o,v):(l=de(o),l.c(),l.m(i,null)):l&&(l.d(1),l=null)},i(o){n||(w(t.$$.fragment,o),n=!0)},o(o){D(t.$$.fragment,o),n=!1},d(o){o&&_(s),J(t),o&&_(e),o&&_(i),l&&l.d()}}}function de(a){var i,n;let s=((n=(i=a[5])==null?void 0:i.data)==null?void 0:n.total_num_rows)+"",t,e;return{c(){t=F(s),e=F(" rows loaded")},l(l){t=P(l,s),e=P(l," rows loaded")},m(l,r){$(l,t,r),$(l,e,r)},p(l,r){var m,o;r&32&&s!==(s=((o=(m=l[5])==null?void 0:m.data)==null?void 0:o.total_num_rows)+"")&&X(t,s)},d(l){l&&_(t),l&&_(e)}}}function Ke(a){let s,t;return s=new he({props:{hideCloseButton:!0,kind:"error",fullWidth:!0,lowContrast:!0,title:"Error loading dataset",caption:a[3].error||void 0}}),{c(){U(s.$$.fragment)},l(e){W(s.$$.fragment,e)},m(e,i){z(s,e,i),t=!0},p(e,i){const n={};i&8&&(n.caption=e[3].error||void 0),s.$set(n)},i(e){t||(w(s.$$.fragment,e),t=!0)},o(e){D(s.$$.fragment,e),t=!1},d(e){J(s,e)}}}function Xe(a){let s,t,e,i,n,l,r,m,o,v,p,k,g,T,S,u=a[2]&&ce(a),f=a[9]!=null&&me(a);return T=new Je({props:{disabled:a[2]==null,size:"xl",icon:je,iconDescription:"Open dataset",$$slots:{default:[Ye]},$$scope:{ctx:a}}}),T.$on("click",a[26]),{c(){s=N("div"),t=N("section"),e=N("div"),i=N("div"),n=F("Step 2: Choose settings"),l=A(),r=N("div"),m=F("These settings can be changed from the dataset page at any time."),o=A(),u&&u.c(),v=A(),p=N("div"),f&&f.c(),k=A(),g=N("div"),U(T.$$.fragment),this.h()},l(c){s=C(c,"DIV",{class:!0});var h=R(s);t=C(h,"SECTION",{class:!0});var O=R(t);e=C(O,"DIV",{class:!0});var d=R(e);i=C(d,"DIV",{class:!0});var b=R(i);n=P(b,"Step 2: Choose settings"),b.forEach(_),l=M(d),r=C(d,"DIV",{class:!0});var V=R(r);m=P(V,"These settings can be changed from the dataset page at any time."),V.forEach(_),d.forEach(_),o=M(O),u&&u.l(O),O.forEach(_),h.forEach(_),v=M(c),p=C(c,"DIV",{});var j=R(p);f&&f.l(j),j.forEach(_),k=M(c),g=C(c,"DIV",{class:!0});var y=R(g);W(T.$$.fragment,y),y.forEach(_),this.h()},h(){q(i,"class","text-2xl text-gray-700"),q(r,"class","text-sm text-gray-500"),q(e,"class","flex flex-col gap-y-2"),q(t,"class","flex flex-col gap-y-4"),q(s,"class","my-8"),q(g,"class","dataset-link mt-8")},m(c,h){$(c,s,h),E(s,t),E(t,e),E(e,i),E(i,n),E(e,l),E(e,r),E(r,m),E(t,o),u&&u.m(t,null),$(c,v,h),$(c,p,h),f&&f.m(p,null),$(c,k,h),$(c,g,h),z(T,g,null),S=!0},p(c,h){c[2]?u?(u.p(c,h),h&4&&w(u,1)):(u=ce(c),u.c(),w(u,1),u.m(t,null)):u&&(G(),D(u,1,1,()=>{u=null}),K()),c[9]!=null?f?(f.p(c,h),h&512&&w(f,1)):(f=me(c),f.c(),w(f,1),f.m(p,null)):f&&(G(),D(f,1,1,()=>{f=null}),K());const O={};h&4&&(O.disabled=c[2]==null),h&268435456&&(O.$$scope={dirty:h,ctx:c}),T.$set(O)},i(c){S||(w(u),w(f),w(T.$$.fragment,c),S=!0)},o(c){D(u),D(f),D(T.$$.fragment,c),S=!1},d(c){c&&_(s),u&&u.d(),c&&_(v),c&&_(p),f&&f.d(),c&&_(k),c&&_(g),J(T)}}}function ce(a){let s,t,e;function i(l){a[25](l)}let n={namespace:a[0],datasetName:a[1]};return a[2]!==void 0&&(n.newSettings=a[2]),s=new ye({props:n}),Ie.push(()=>$e(s,"newSettings",i)),{c(){U(s.$$.fragment)},l(l){W(s.$$.fragment,l)},m(l,r){z(s,l,r),e=!0},p(l,r){const m={};r&1&&(m.namespace=l[0]),r&2&&(m.datasetName=l[1]),!t&&r&4&&(t=!0,m.newSettings=l[2],De(()=>t=!1)),s.$set(m)},i(l){e||(w(s.$$.fragment,l),e=!0)},o(l){D(s.$$.fragment,l),e=!1},d(l){J(s,l)}}}function me(a){let s,t,e,i,n;return i=new Ne({props:{rowId:a[9],mediaFields:a[7],highlightedFields:a[8]}}),{c(){s=N("div"),t=F("Preview"),e=A(),U(i.$$.fragment),this.h()},l(l){s=C(l,"DIV",{class:!0});var r=R(s);t=P(r,"Preview"),r.forEach(_),e=M(l),W(i.$$.fragment,l),this.h()},h(){q(s,"class","text-xl text-gray-700")},m(l,r){$(l,s,r),E(s,t),$(l,e,r),z(i,l,r),n=!0},p(l,r){const m={};r&512&&(m.rowId=l[9]),r&128&&(m.mediaFields=l[7]),r&256&&(m.highlightedFields=l[8]),i.$set(m)},i(l){n||(w(i.$$.fragment,l),n=!0)},o(l){D(i.$$.fragment,l),n=!1},d(l){l&&_(s),l&&_(e),J(i,l)}}}function Ye(a){let s;return{c(){s=F("Save and open dataset")},l(t){s=P(t,"Save and open dataset")},m(t,e){$(t,s,e)},d(t){t&&_(s)}}}function Ze(a){let s,t,e,i,n=a[4].isSuccess&&a[3]==null&&re(),l=a[3]&&oe(a);return{c(){s=N("div"),t=N("div"),n&&n.c(),e=A(),l&&l.c(),this.h()},l(r){s=C(r,"DIV",{class:!0});var m=R(s);t=C(m,"DIV",{class:!0});var o=R(t);n&&n.l(o),e=M(o),l&&l.l(o),o.forEach(_),m.forEach(_),this.h()},h(){q(t,"class","center-panel mx-auto p-8 svelte-af9918"),q(s,"class","w-full overflow-y-scroll")},m(r,m){$(r,s,m),E(s,t),n&&n.m(t,null),E(t,e),l&&l.m(t,null),i=!0},p(r,[m]){r[4].isSuccess&&r[3]==null?n?m&24&&w(n,1):(n=re(),n.c(),w(n,1),n.m(t,e)):n&&(G(),D(n,1,1,()=>{n=null}),K()),r[3]?l?(l.p(r,m),m&8&&w(l,1)):(l=oe(r),l.c(),w(l,1),l.m(t,null)):l&&(G(),D(l,1,1,()=>{l=null}),K())},i(r){i||(w(n),w(l),i=!0)},o(r){D(n),D(l),i=!1},d(r){r&&_(s),n&&n.d(),l&&l.d()}}}function Qe(a,s,t){let e,i,n,l,r,m,o,v,p,k,g,T,S,u=Z,f=()=>(u(),u=Q(n,I=>t(21,S=I)),n),c,h=Z,O=()=>(h(),h=Q(l,I=>t(22,c=I)),l),d,b,V=Z,j=()=>(V(),V=Q(r,I=>t(5,b=I)),r),y,te=Z,we=()=>(te(),te=Q(i,I=>t(24,y=I)),i);a.$$.on_destroy.push(()=>u()),a.$$.on_destroy.push(()=>h()),a.$$.on_destroy.push(()=>V()),a.$$.on_destroy.push(()=>te());let{namespace:B}=s,{datasetName:L}=s,{loadingTaskId:Y}=s,H;const le=Ce();x(a,le,I=>t(27,g=I));const se=Re(B,L);x(a,se,I=>t(23,d=I)),Fe(se);const ae=Pe();x(a,ae,I=>t(4,T=I));const ke={pending:"active",completed:"finished",error:"error"};function ie(){H!=null&&g.mutate([B,L,H],{onSuccess:()=>{Ve(Ue(B,L))}})}function ve(I){H=I,t(2,H),t(24,y)}const Se=()=>ie();return a.$$set=I=>{"namespace"in I&&t(0,B=I.namespace),"datasetName"in I&&t(1,L=I.datasetName),"loadingTaskId"in I&&t(19,Y=I.loadingTaskId)},a.$$.update=()=>{a.$$.dirty&524304&&t(3,p=Y!=null&&T.data!=null?T.data.tasks[Y]:null),a.$$.dirty&8&&t(20,e=(p==null?void 0:p.status)=="completed"),a.$$.dirty&1048579&&we(t(13,i=e?qe(B,L):null)),a.$$.dirty&16777220&&t(2,H=y!=null&&y.isFetching||(y==null?void 0:y.data)==null?null:H??JSON.parse(JSON.stringify(y==null?void 0:y.data))),a.$$.dirty&1048579&&f(t(12,n=e?Oe(B,L):null)),a.$$.dirty&9437187&&O(t(11,l=e?Be(B,L,Le(d)):null)),a.$$.dirty&2097155&&j(t(10,r=B&&L&&(S==null?void 0:S.data)!=null?He(B,L,{columns:[ne],limit:1,combine_columns:!0},S.data):null)),a.$$.dirty&32&&t(9,m=(b==null?void 0:b.data)!=null?We.value(ze(b.data.rows[0],[ne]),"string"):null),a.$$.dirty&12582912&&t(8,o=Ae(d.query,c==null?void 0:c.data)),a.$$.dirty&2097156&&t(7,v=H!=null&&(S==null?void 0:S.data)!=null?Me(S==null?void 0:S.data,H):[]),a.$$.dirty&8&&t(6,k=(p==null?void 0:p.step_progress)==null?void 0:p.step_progress)},[B,L,H,p,T,b,k,v,o,m,r,l,n,i,le,se,ae,ke,ie,Y,e,S,c,d,y,ve,Se]}class xe extends pe{constructor(s){super(),ge(this,s,Qe,Ze,be,{namespace:0,datasetName:1,loadingTaskId:19})}}function _e(a){let s,t;return s=new xe({props:{namespace:a[0],datasetName:a[1],loadingTaskId:a[2]}}),{c(){U(s.$$.fragment)},l(e){W(s.$$.fragment,e)},m(e,i){z(s,e,i),t=!0},p(e,i){const n={};i&1&&(n.namespace=e[0]),i&2&&(n.datasetName=e[1]),i&4&&(n.loadingTaskId=e[2]),s.$set(n)},i(e){t||(w(s.$$.fragment,e),t=!0)},o(e){D(s.$$.fragment,e),t=!1},d(e){J(s,e)}}}function et(a){let s,t,e=a[0]!=null&&a[1]!=null&&a[2]!=null&&_e(a);return{c(){e&&e.c(),s=ee()},l(i){e&&e.l(i),s=ee()},m(i,n){e&&e.m(i,n),$(i,s,n),t=!0},p(i,n){i[0]!=null&&i[1]!=null&&i[2]!=null?e?(e.p(i,n),n&7&&w(e,1)):(e=_e(i),e.c(),w(e,1),e.m(s.parentNode,s)):e&&(G(),D(e,1,1,()=>{e=null}),K())},i(i){t||(w(e),t=!0)},o(i){D(e),t=!1},d(i){e&&e.d(i),i&&_(s)}}}function tt(a){let s,t;return s=new Ee({props:{$$slots:{default:[et]},$$scope:{ctx:a}}}),{c(){U(s.$$.fragment)},l(e){W(s.$$.fragment,e)},m(e,i){z(s,e,i),t=!0},p(e,[i]){const n={};i&39&&(n.$$scope={dirty:i,ctx:e}),s.$set(n)},i(e){t||(w(s.$$.fragment,e),t=!0)},o(e){D(s.$$.fragment,e),t=!1},d(e){J(s,e)}}}function st(a,s,t){let e,i,n,l;const r=Ge();return x(a,r,m=>t(4,e=m)),a.$$.update=()=>{a.$$.dirty&16&&e.page==="datasets/loading"&&e.identifier!=null&&t(0,[i,n,l]=e.identifier.split("/"),i,(t(1,n),t(4,e)),(t(2,l),t(4,e)))},[i,n,l,r,e]}class ft extends pe{constructor(s){super(),ge(this,s,st,tt,be,{})}}export{ft as component};
